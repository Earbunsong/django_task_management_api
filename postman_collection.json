{
  "info": {
    "name": "Task Management System API v1",
    "schema": "https://schema.getpostman.com/json/collection/v2.1.0/collection.json"
  },
  "item": [
    {
      "name": "Auth",
      "item": [
        {
          "name": "Register",
          "request": {
            "method": "POST",
            "header": [
              { "key": "Content-Type", "value": "application/json" }
            ],
            "url": "{{base_url}}/auth/register/",
            "body": {
              "mode": "raw",
              "raw": "{\n  \"username\": \"alice\",\n  \"email\": \"alice@example.com\",\n  \"password\": \"StrongPass123!\"\n}"
            }
          }
        },
        {
          "name": "Login (JWT)",
          "request": {
            "method": "POST",
            "header": [
              { "key": "Content-Type", "value": "application/json" }
            ],
            "url": "{{base_url}}/auth/login/",
            "body": {
              "mode": "raw",
              "raw": "{\n  \"username\": \"alice\",\n  \"password\": \"StrongPass123!\"\n}"
            }
          },
          "event": [
            {
              "listen": "test",
              "script": {
                "type": "text/javascript",
                "exec": [
                  "if (pm.response.code === 200) {",
                  "  const data = pm.response.json();",
                  "  if (data.access) pm.collectionVariables.set('access_token', data.access);",
                  "  if (data.refresh) pm.collectionVariables.set('refresh_token', data.refresh);",
                  "}"
                ]
              }
            }
          ]
        },
        {
          "name": "Refresh Token",
          "request": {
            "method": "POST",
            "header": [
              { "key": "Content-Type", "value": "application/json" }
            ],
            "url": "{{base_url}}/auth/token/refresh/",
            "body": {
              "mode": "raw",
              "raw": "{\n  \"refresh\": \"{{refresh_token}}\"\n}"
            }
          },
          "event": [
            {
              "listen": "test",
              "script": {
                "type": "text/javascript",
                "exec": [
                  "if (pm.response.code === 200) {",
                  "  const data = pm.response.json();",
                  "  if (data.access) pm.collectionVariables.set('access_token', data.access);",
                  "}"
                ]
              }
            }
          ]
        },
        {
          "name": "Profile - Get",
          "request": {
            "method": "GET",
            "header": [
              { "key": "Authorization", "value": "Bearer {{access_token}}" }
            ],
            "url": "{{base_url}}/auth/profile/"
          }
        },
        {
          "name": "Profile - Update",
          "request": {
            "method": "PUT",
            "header": [
              { "key": "Content-Type", "value": "application/json" },
              { "key": "Authorization", "value": "Bearer {{access_token}}" }
            ],
            "url": "{{base_url}}/auth/profile/",
            "body": {
              "mode": "raw",
              "raw": "{\n  \"first_name\": \"Alice\",\n  \"last_name\": \"Doe\"\n}"
            }
          }
        }
      ]
    },
    {
      "name": "Tasks",
      "item": [
        {
          "name": "List Tasks",
          "request": {
            "method": "GET",
            "header": [
              { "key": "Authorization", "value": "Bearer {{access_token}}" }
            ],
            "url": "{{base_url}}/tasks/"
          }
        },
        {
          "name": "Create Task",
          "request": {
            "method": "POST",
            "header": [
              { "key": "Content-Type", "value": "application/json" },
              { "key": "Authorization", "value": "Bearer {{access_token}}" }
            ],
            "url": "{{base_url}}/tasks/",
            "body": {
              "mode": "raw",
              "raw": "{\n  \"title\": \"Write BRD\",\n  \"description\": \"Draft Task Management BRD\",\n  \"due_date\": \"2025-12-31\",\n  \"priority\": \"medium\",\n  \"status\": \"todo\"\n}"
            }
          },
          "event": [
            {
              "listen": "test",
              "script": {
                "type": "text/javascript",
                "exec": [
                  "if (pm.response.code === 201) {",
                  "  const data = pm.response.json();",
                  "  if (data.id) pm.collectionVariables.set('task_id', data.id);",
                  "}"
                ]
              }
            }
          ]
        },
        {
          "name": "Get Task by ID",
          "request": {
            "method": "GET",
            "header": [
              { "key": "Authorization", "value": "Bearer {{access_token}}" }
            ],
            "url": "{{base_url}}/tasks/{{task_id}}/"
          }
        },
        {
          "name": "Update Task",
          "request": {
            "method": "PUT",
            "header": [
              { "key": "Content-Type", "value": "application/json" },
              { "key": "Authorization", "value": "Bearer {{access_token}}" }
            ],
            "url": "{{base_url}}/tasks/{{task_id}}/",
            "body": {
              "mode": "raw",
              "raw": "{\n  \"title\": \"Write BRD (updated)\",\n  \"status\": \"in_progress\"\n}"
            }
          }
        },
        {
          "name": "Delete Task",
          "request": {
            "method": "DELETE",
            "header": [
              { "key": "Authorization", "value": "Bearer {{access_token}}" }
            ],
            "url": "{{base_url}}/tasks/{{task_id}}/"
          }
        },
        {
          "name": "Assign Task (Pro only)",
          "request": {
            "method": "POST",
            "header": [
              { "key": "Content-Type", "value": "application/json" },
              { "key": "Authorization", "value": "Bearer {{access_token}}" }
            ],
            "url": "{{base_url}}/tasks/{{task_id}}/assign/",
            "body": {
              "mode": "raw",
              "raw": "{\n  \"user_id\": 1\n}"
            }
          }
        },
        {
          "name": "Upload Media (Cloudinary URL)",
          "request": {
            "method": "POST",
            "header": [
              { "key": "Content-Type", "value": "application/json" },
              { "key": "Authorization", "value": "Bearer {{access_token}}" }
            ],
            "url": "{{base_url}}/tasks/{{task_id}}/media/",
            "body": {
              "mode": "raw",
              "raw": "{\n  \"file_url\": \"https://res.cloudinary.com/demo/image/upload/sample.jpg\",\n  \"file_type\": \"image/jpeg\"\n}"
            }
          }
        },
        {
          "name": "Get Task Media",
          "request": {
            "method": "GET",
            "header": [
              { "key": "Authorization", "value": "Bearer {{access_token}}" }
            ],
            "url": "{{base_url}}/tasks/{{task_id}}/media/"
          }
        }
      ]
    },
    {
      "name": "Payments",
      "item": [
        {
          "name": "Create Checkout Session",
          "request": {
            "method": "POST",
            "header": [
              { "key": "Authorization", "value": "Bearer {{access_token}}" }
            ],
            "url": "{{base_url}}/payment/create-session/"
          }
        },
        {
          "name": "Get Subscription",
          "request": {
            "method": "GET",
            "header": [
              { "key": "Authorization", "value": "Bearer {{access_token}}" }
            ],
            "url": "{{base_url}}/payment/subscription/"
          }
        },
        {
          "name": "Cancel Subscription",
          "request": {
            "method": "POST",
            "header": [
              { "key": "Authorization", "value": "Bearer {{access_token}}" }
            ],
            "url": "{{base_url}}/payment/cancel/"
          }
        },
        {
          "name": "Payment History",
          "request": {
            "method": "GET",
            "header": [
              { "key": "Authorization", "value": "Bearer {{access_token}}" }
            ],
            "url": "{{base_url}}/payment/history/"
          }
        }
      ]
    },
    {
      "name": "Notifications",
      "item": [
        {
          "name": "List Notifications",
          "request": {
            "method": "GET",
            "header": [
              { "key": "Authorization", "value": "Bearer {{access_token}}" }
            ],
            "url": "{{base_url}}/notifications/"
          }
        },
        {
          "name": "Mark as Read",
          "request": {
            "method": "PATCH",
            "header": [
              { "key": "Authorization", "value": "Bearer {{access_token}}" }
            ],
            "url": "{{base_url}}/notifications/{{notification_id}}/read/"
          }
        },
        {
          "name": "Register FCM Token",
          "request": {
            "method": "POST",
            "header": [
              { "key": "Content-Type", "value": "application/json" },
              { "key": "Authorization", "value": "Bearer {{access_token}}" }
            ],
            "url": "{{base_url}}/notifications/register-token/",
            "body": {
              "mode": "raw",
              "raw": "{\n  \"token\": \"demo-device-token\"\n}"
            }
          }
        }
      ]
    },
    {
      "name": "Admin",
      "item": [
        {
          "name": "All Users (Admin)",
          "request": {
            "method": "GET",
            "header": [
              { "key": "Authorization", "value": "Bearer {{access_token}}" }
            ],
            "url": "{{base_url}}/admin/users/"
          }
        },
        {
          "name": "All Payments (Admin)",
          "request": {
            "method": "GET",
            "header": [
              { "key": "Authorization", "value": "Bearer {{access_token}}" }
            ],
            "url": "{{base_url}}/admin/payments/"
          }
        },
        {
          "name": "Export Users CSV",
          "request": {
            "method": "GET",
            "header": [
              { "key": "Authorization", "value": "Bearer {{access_token}}" }
            ],
            "url": "{{base_url}}/admin/export/users/"
          }
        },
        {
          "name": "Export Payments CSV",
          "request": {
            "method": "GET",
            "header": [
              { "key": "Authorization", "value": "Bearer {{access_token}}" }
            ],
            "url": "{{base_url}}/admin/export/payments/"
          }
        }
      ]
    }
  ],
  "variable": [
    { "key": "base_url", "value": "http://127.0.0.1:8000/api/v1" },
    { "key": "access_token", "value": "" },
    { "key": "refresh_token", "value": "" },
    { "key": "task_id", "value": "" },
    { "key": "notification_id", "value": "" }
  ]
}
